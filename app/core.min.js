window.fromStorage=function(e){return localStorage.getItem(e)},window.toStorage=function(e,t,o){localStorage.setItem(e,t),o&&(window[o]=t)},window.removeStorage=function(e){localStorage.removeItem(e)},window.clearStorage=function(){localStorage.clear()},window.observeOn=function(e,t,o,n,r){var i=new MutationObserver(function(t){t.forEach(function(t){if("style"===t.attributeName){var a=e.split(":"),c=a[1],d=a[2];getComputedStyle(t.target).getPropertyValue(c)===d&&(n>0?setTimeout(function(){o.call(r||null),i.disconnect()},n):(o.call(r||null),i.disconnect()))}})});i.observe(t,{attributes:!0})};var lastLoaded=null;window.DataExtend=async function(e,t,o=0){if(o>=e.length)return void("function"==typeof t&&t());const n=e[o],{type:r,source:i,anchor:a,pos:c,id:d,as:s}=n;if("data"===r){try{const n=await fetch(i);if(!n.ok)throw new Error(`Failed to fetch ${i}`);const r=await n.json();if(void 0!==s)return window[s]=r,void await DataExtend(e,t,o+1)}catch(e){console.error(`Ошибка загрузки ${i}:`,e)}return void await DataExtend(e,t,o+1)}const l=document.createElement("script"===r?"script":"link");if("script"===r?l.src=i:(l.rel="stylesheet",i&&(l.href=i)),d&&(l.id=d),"previous"===a&&lastLoaded){const e=document.querySelector(lastLoaded);e&&("before"===c?e.parentNode.insertBefore(l,e):e.parentNode.insertBefore(l,e.nextSibling))}else{const e=document.querySelector(a);e&&("inner-start"===c?e.insertBefore(l,e.firstChild):"inner-end"===c?e.appendChild(l):"before"===c?e.parentNode.insertBefore(l,e):"after"===c&&e.parentNode.insertBefore(l,e.nextSibling))}lastLoaded="script"===r?`script[src="${i}"]`:`link[href="${i}"]`,i?(await new Promise(e=>{l.onload=(()=>{e()}),l.onerror=(t=>{console.error(`Ошибка загрузки ${i}:`,t),e()})}),await DataExtend(e,t,o+1)):await DataExtend(e,t,o+1)},window.waitFor=function(e,t){const o=document.querySelector(e);if(o)return void t();const n=new MutationObserver((o,n)=>{for(const r of o)if("childList"===r.type&&r.addedNodes.length>0)for(const o of r.addedNodes)if(1===o.nodeType&&o.matches(e))return n.disconnect(),void t()});n.observe(document.documentElement,{childList:!0,subtree:!0})};