@layer element {
  tooltip-element {
    position: fixed;
    display: flex;
    flex-direction: row;
    align-items: flex-start;
    justify-content: center;
    filter: drop-shadow(0 5px 10px var(--shadow_22a29)) drop-shadow(0 2px 1px var(--shadow_22a29));
    font-family: var(--font_common_set);
    transition: all 0.1s ease;
    opacity: 0;
    user-select: none;
    pointer-events: none;
    z-index: 1080;
    cursor: pointer;

    &[data-prevent_close="true"] {
      cursor: unset;
      &.tl-pinned {
        transition: all 0.3s ease;
        &.tl-highlight {filter: drop-shadow(0 5px 10px var(--color_gold_light)) drop-shadow(0 2px 1px var(--shadow_22a29)) brightness(105%) sepia(50%) saturate(150%);}
      

        &::before {
          content: 'push_pin';
          font-family: 'Material Icons';
          font-size: 11pt;
          line-height: 1em;
          position: absolute;
          top: -5px;
          right: -5px;
          rotate: 45deg;
          filter: drop-shadow(0 2px 1px var(--shadow_22a29));
          opacity: 0.65;
          z-index: 9999;
          user-select: none;
          pointer-events: none;
        }
        &:has([tooltip-pos='right'])::before {
          right: auto;
          left: -5px;
          rotate: -45deg;
        }
        &:has([tooltip-pos='top'])::before {
          top: -20px;
        }
      }
    }
  
    &.show {
      pointer-events: all;
      user-select: text;
    }
  
    & .tl-content {
      max-height: 768px;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: var(--tooltip_body);
      padding: 10px 15px;
      line-break: auto;
      hyphens: auto;
      word-break: normal;
      white-space: normal;
      word-spacing: normal;
      word-wrap: break-word;
      z-index: 1;

      &:has(.Preview_tooltip) {
        padding: 0;
        padding-block-end: 10px;
        overflow: hidden;
      }
      & .Preview_tooltip {
        max-width: 384px;
        display: grid;
        grid-template-columns: 1fr;
        grid-template-rows: 1fr auto 1em;
        gap: 0px;
        flex-direction: column;
        align-items: center;
        justify-items: center;
        justify-content: start;
        margin: 0;
      
        & .Preview_tooltip-img {
          --shift: center;
          width: 100%;
          max-height: 170px;
          object-fit: cover;
          overflow: hidden;
          object-position: var(--shift);
        }
        & .Preview_tooltip-content {
          width: calc(100% - 15px);
          max-height: 512px;
          overflow: auto;
          display: flex;
          flex-direction: column;
          align-items: start;
          justify-content: start;
          gap: 10px;
          padding-inline: 5px;
          padding-block: 20px;

          scrollbar-color: var(--shadow_22a29) transparent;
          & ::-webkit-scrollbar-thumb {
            background-color: var(--shadow_22a29) transparent;
          }
        }
        & .Preview_tooltip-subscript {
          width: calc(100% - 15px);
          display: flex;
          height: 1.5em;
          font-size: 0.75em;
          font-style: italic;
          opacity: 0.5;
          padding-inline: 5px;
        }
      }
    }
  
    & .tl-arrow {
      position: absolute;
      display: block;
      width: 24px;
      height: 24px;
      background: var(--tooltip_body);
      mask: url('../../../resources/filters/triangle.svg') no-repeat;
      mask-size: 100% 100%;
      z-index: -1;
    
      &[tooltip-pos='bottom'] {
        top: -15px;
        left: 50%;
        bottom: auto;
        mask: url('../../../resources/filters/triangle_up.svg') no-repeat;
        mask-size: 100% 100%;
        background: var(--tooltip_top);
        translate: -50%;
      }
      &[tooltip-pos='top'] {
        left: 50%;
        bottom: -15px;
        background: var(--tooltip_bottom);
        translate: -50%;
      }
      &[tooltip-pos='right'] {
        top: 50%;
        left: -15px;
        translate: 0 -50%;
        rotate: 90deg;
      }
      &[tooltip-pos='left'] {
        top: 50%;
        right: -15px;
        translate: 0 -50%;
        rotate: -90deg;
      }
    
      &[tooltip-pos='bottom'] ~ .tl-close {
        border-radius: 0 0 10px 10px;
        width: 100%;
        height: 18px;
        bottom: -15px;
      }
      &[tooltip-pos='top'] ~ .tl-close {
        border-radius: 10px 10px 0 0;
        width: 100%;
        height: 18px;
        top: -15px;
        filter: drop-shadow(0 5px 5px var(--shadow_22a10));
      }
      &[tooltip-pos='right'] ~ .tl-close {
        border-radius: 0 10px 10px 0;
        width: 18px;
        height: 100%;
        top: 0;
        right: -15px;
        filter: drop-shadow(-5px 0 5px var(--shadow_22a10));
      }
      &[tooltip-pos='left'] ~ .tl-close {
        border-radius: 10px 0 0 10px;
        width: 18px;
        height: 100%;
        top: 0;
        left: -15px;
        filter: drop-shadow(5px 0 5px var(--shadow_22a10));
      }
    }
  
    & .tl-close {
      font-family: 'Material Icons';
      color: #aaa;
      position: absolute;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      background: var(--tooltip_body);
      font-size: 0.8em;
      user-select: none;
      cursor: pointer;
      z-index: 1;
    
      &:active {
        font-size: 0.65em;
      }
      &:hover {
        background: white;
        color: #555;
      }
    }
  
    &:has(.tl-arrow[tooltip-pos='bottom']):has(.tl-close) {
      .tl-content {
        border-radius: 10px 10px 0 0;
      }
    }
    &:has(.tl-arrow[tooltip-pos='top']):has(.tl-close) {
      .tl-content {
        border-radius: 0 0 10px 10px;
      }
    }
    &:has(.tl-arrow[tooltip-pos='right']):has(.tl-close) {
      .tl-content {
        border-radius: 10px 0 0 10px;
      }
    }
    &:has(.tl-arrow[tooltip-pos='left']):has(.tl-close) {
      .tl-content {
        border-radius: 0 10px 10px 0;
      }
    }
    & ruby {
      font-size: 1.25rem;
    }
  }
  & .tooltip-h1 {
    width: 100%;
    display: inline-flex;
    align-items: start;
    justify-content: space-between;
    font-size: 1.75rem;
    font-family: var(--font_header_set);
    font-weight: 800;
    margin: 0;

    & .tooltip-logo{
      width: 1.5rem;
    }
  }
}

.tooltip-quest {
  text-decoration: underline dotted grey;
  text-underline-offset: 0.25em;
  color: var(--color_orange_gold);
  cursor: help;
  vertical-align: super;
  font-size: 0.85em;
}


